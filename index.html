<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Portfolio | Owen Kelley</title>
<link rel="stylesheet" href="styles.css" />
</head>
<body>
<header>
        <nav>
        <ul>
          <li><a href="#/home" data-route="home">Home</a></li>
          <li><a href="#/about" data-route="about">About</a></li>
          <li><a href="#/experience" data-route="experience">Experience</a></li>
          <li><a href="#/projects" data-route="projects">Projects</a></li>
        </ul>
      </nav>
</header>

<main>
  <!-- HOME PAGE (intro only) -->
  <div class="page home-page" data-page="home">
    <section id="intro">
      <div class="centered-container">
        <div class="intro-text" id="introText">
          <div class="intro-lines">
            <div class="intro-line small">
              <span id="hiLine"></span>
              <span class="caret" aria-hidden="true"></span>
            </div>
          
            <div class="intro-line big" id="bigLine">
              <span class="name-spot">
                <span id="nameLine" class="aurora-text"></span>
              </span>
            </div> 
            <div class="intro-line small role-rotator" id="roleRotator" aria-live="polite" aria-atomic="true"></div>                    
          </div>
        </div>
      </div>
      <!-- Visualizer canvas sits behind content -->
      <canvas id="musicViz" aria-hidden="true"></canvas>

      <!-- Audio controls (small chip) -->
      <div class="audio-chip" id="audioChip" hidden>
        <button id="audioToggle" aria-pressed="false" aria-label="Play music">‚ô´ Play</button>
      </div>      

      <!-- Your track (swap src with your file/URL) -->
      <audio id="heroTrack" src="audio/welcome.mp3" preload="auto"></audio>
    </section>
  </div>

  <!-- PROJECTS PAGE (isolated) -->
  <div class="page projects-page" data-page="projects">
    <section id="projects" class="anchor" aria-label="Projects">
      <div class="projects-grid-container">
        <div class="projects-grid">
          <!-- Project 1 -->
          <article class="project-item" role="group" aria-label="ADFS + Duo MFA Integration">
            <div class="project-card">
              <div class="expand-tooltip" data-expand="Click to expand" data-collapse="Click to minimize"></div>
              <div class="project-header">
                <h3>ADFS + Duo MFA Integration</h3>
                <p class="project-desc">Deployed a .NET app for Windows endpoints, integrating ADFS with Duo MFA to harden authentication with minimal user friction.</p>
                <div class="tags"><span class="tag">C#</span><span class="tag">.NET</span><span class="tag">ADFS</span><span class="tag">Duo</span><span class="tag">Security</span></div>
                <div class="divider"></div>
                <ul class="bullets">
                  <li>Reduced risky sign-ins by 42% post rollout.</li>
                  <li>Graceful fallbacks for offline devices.</li>
                  <li>Automated installer & health checks.</li>
                </ul>
              </div>
              <div class="project-media"><span>Image / GIF</span></div>
            </div>
          </article>
          
          <!-- Project 2 -->
          <article class="project-item" role="group" aria-label="Active Directory Auth Gateway">
            <div class="project-card">
              <div class="expand-tooltip" data-expand="Click to expand" data-collapse="Click to minimize"></div>
              <div class="project-header">
                <h3>Active Directory Auth Gateway</h3>
                <p class="project-desc">Azure gateway VM intercepting Kerberos/NTLM to apply conditional access and 2FA‚Äîno agents on domain controllers.</p>
                <div class="tags"><span class="tag">Azure</span><span class="tag">.NET</span><span class="tag">Kerberos</span><span class="tag">NTLM</span></div>
                <div class="divider"></div>
                <ul class="bullets">
                  <li>WFP-based port inspection & policy engine.</li>
                  <li>Per-request Duo prompt with allow/deny.</li>
                  <li>Traffic shaping for lab replay tests.</li>
                </ul>
              </div>
              <div class="project-media"><span>Diagram</span></div>
            </div>
          </article>
          
          <!-- Project 3 -->
          <article class="project-item" role="group" aria-label="Fitness Tracking App">
            <div class="project-card">
              <div class="expand-tooltip" data-expand="Click to expand" data-collapse="Click to minimize"></div>
              <div class="project-header">
                <h3>Fitness Tracking App</h3>
                <p class="project-desc">SwiftUI mobile app to create and track workouts, integrating WHOOP data to adjust training intensity dynamically.</p>
                <div class="tags"><span class="tag">SwiftUI</span><span class="tag">iOS</span><span class="tag">Health APIs</span></div>
                <div class="divider"></div>
                <ul class="bullets">
                  <li>Workout builder with sets/reps/weights.</li>
                  <li>Zone-based trends & auto-adjustments.</li>
                  <li>Clean, offline-first local store.</li>
                </ul>
              </div>
              <div class="project-media"><span>App Screens</span></div>
            </div>
          </article>
          
          <!-- Project 4 -->
          <article class="project-item" role="group" aria-label="Network Security Dashboard">
            <div class="project-card">
              <div class="expand-tooltip" data-expand="Click to expand" data-collapse="Click to minimize"></div>
              <div class="project-header">
                <h3>Network Security Dashboard</h3>
                <p class="project-desc">Real-time monitoring system for network traffic analysis with threat detection and automated response capabilities.</p>
                <div class="tags"><span class="tag">Python</span><span class="tag">React</span><span class="tag">Docker</span><span class="tag">Security</span></div>
                <div class="divider"></div>
                <ul class="bullets">
                  <li>Real-time packet analysis and threat detection.</li>
                  <li>Machine learning-based anomaly detection.</li>
                  <li>Automated incident response workflows.</li>
                </ul>
              </div>
              <div class="project-media"><span>Dashboard</span></div>
            </div>
          </article>
        </div>
      </div>
    </section>
  </div>

  <!-- ABOUT PAGE -->
  <div class="page about-page" data-page="about">
    <section id="about" class="anchor" aria-label="About">
      <div class="section-inner">
        <h2>About Me</h2>
        <div class="about-content">
          <div class="about-left">
            <div class="about-text">
              <p>I'm a security-focused engineer with a passion for building robust, user-friendly solutions that solve real-world problems. With expertise in authentication systems, cloud infrastructure, and mobile development, I bridge the gap between security requirements and user experience.</p>
              <p>My approach combines technical depth with practical thinking‚ÄîI believe the best security solutions are those that users actually want to use. Whether it's implementing MFA systems that reduce friction or building intuitive mobile apps, I focus on creating experiences that work seamlessly in the real world.</p>
              <p>When I'm not coding, you'll find me exploring new technologies, contributing to open source projects, or staying active with fitness tracking and health optimization.</p>
            </div>
            <div class="about-highlights">
              <div class="highlight-item">
                <h3>Security-First</h3>
                <p>Building authentication and authorization systems that protect without compromising usability</p>
              </div>
              <div class="highlight-item">
                <h3>User-Centric</h3>
                <p>Designing solutions that solve real problems while maintaining excellent user experience</p>
              </div>
              <div class="highlight-item">
                <h3>Problem Solver</h3>
                <p>Approaching complex technical challenges with systematic thinking and practical solutions</p>
              </div>
            </div>
          </div>
          <div class="about-right">
            <div class="headshot-container">
              <img src="images/headshot.png" alt="Owen Kelley - Security Engineer" class="headshot">
            </div>
          </div>
        </div>
          
          <div class="contact-section">
            <h3>Let's Connect</h3>
            <p>I'm always interested in new opportunities and collaborations. Whether you have a project in mind or just want to chat about technology and security, feel free to reach out.</p>
            
            <div class="contact-methods">
              <div class="contact-method">
                <span class="contact-icon">üìß</span>
                <div>
                  <h4>Email</h4>
                  <a href="mailto:owenbkelley@gmail.com">owenbkelley@gmail.com</a>
                </div>
              </div>
              
              <div class="contact-method">
                <span class="contact-icon">üíº</span>
                <div>
                  <h4>LinkedIn</h4>
                  <a href="https://www.linkedin.com/in/owenbkelley/" target="_blank" rel="noopener">linkedin.com/in/owenbkelley</a>
                </div>
              </div>
              
              <div class="contact-method">
                <span class="contact-icon">üêô</span>
                <div>
                  <h4>GitHub</h4>
                  <a href="https://github.com/B3A5TM0DE" target="_blank" rel="noopener">github.com/B3A5TM0DE</a>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- EXPERIENCE PAGE -->
  <div class="page experience-page" data-page="experience">
    <section id="experience" class="anchor" aria-label="Experience">
      <div class="section-inner">

        
        <div class="experience-content">
          <div class="experience-section">
            <h3>Work Experience</h3>
            
            <div class="job-card" data-expand="Click to expand" data-collapse="Click to minimize">
              <div class="expand-tooltip" data-expand="Click to expand" data-collapse="Click to minimize"></div>
              <div class="job-header">
                <h4>Software Engineer II</h4>
                <span class="company">Cisco (Duo Security)</span>
                <span class="period">July 2024 ‚Äì Present</span>
                <span class="location">San Diego, CA</span>
              </div>
              <p class="job-description">Developing and deploying .NET applications for Windows endpoints and leading releases for multiple Duo products.</p>
              <div class="tech-stack">
                <span class="tech-tag">C#</span>
                <span class="tech-tag">.NET</span>
                <span class="tech-tag">Azure</span>
                <span class="tech-tag">ADFS</span>
                <span class="tech-tag">PowerShell</span>
              </div>
              
              <!-- Expanded content that only shows when job-card has 'expanded' class -->
              <div class="expanded-content">
                <h5>Key Responsibilities & Achievements:</h5>
                <ul class="expanded-bullets">
                  <li>Lead development of Windows endpoint applications for enterprise security and authentication</li>
                  <li>Architect and implement ADFS integration solutions with Duo MFA for enterprise customers</li>
                  <li>Manage release cycles for multiple Duo products, ensuring quality and timely delivery</li>
                  <li>Design and deploy Azure-based infrastructure for scalable security applications</li>
                  <li>Collaborate with cross-functional teams to define product requirements and technical specifications</li>
                  <li>Mentor junior developers and conduct code reviews to maintain code quality standards</li>
                </ul>
                
                <h5>Technical Projects:</h5>
                <ul class="expanded-bullets">
                  <li>Developed automated deployment pipelines for Windows endpoint security applications</li>
                  <li>Implemented comprehensive logging and monitoring systems for production environments</li>
                  <li>Created PowerShell automation scripts for enterprise deployment and configuration management</li>
                </ul>
              </div>
            </div>
            
            <div class="job-card" data-expand="Click to expand" data-collapse="Click to minimize">
              <div class="expand-tooltip" data-expand="Click to expand" data-collapse="Click to minimize"></div>
              <div class="job-header">
                <h4>Software Engineer</h4>
                <span class="company">STR</span>
                <span class="period">September 2023 ‚Äì May 2024</span>
                <span class="location">Claremont, CA</span>
              </div>
              <p class="job-description">Developed and implemented a 4G/LTE network solution, leveraging open-source tools and software engineering techniques.</p>
              <div class="tech-stack">
                <span class="tech-tag">4G/LTE</span>
                <span class="tech-tag">Network Infrastructure</span>
                <span class="tech-tag">Open Source</span>
              </div>
              
              <!-- Expanded content that only shows when job-card has 'expanded' class -->
              <div class="expanded-content">
                <h5>Key Responsibilities & Achievements:</h5>
                <ul class="expanded-bullets">
                  <li>Designed and implemented 4G/LTE network infrastructure solutions for research and development environments</li>
                  <li>Leveraged open-source networking tools to create cost-effective and scalable network solutions</li>
                  <li>Developed custom software components to enhance network performance and monitoring capabilities</li>
                  <li>Collaborated with research teams to understand network requirements and implement appropriate solutions</li>
                  <li>Documented network architecture and provided technical support for research projects</li>
                </ul>
                
                <h5>Technical Projects:</h5>
                <ul class="expanded-bullets">
                  <li>Built network monitoring and diagnostic tools for 4G/LTE infrastructure</li>
                  <li>Implemented network security protocols and access control mechanisms</li>
                  <li>Created automated network configuration and deployment scripts</li>
                </ul>
              </div>
            </div>

            <div class="job-card" data-expand="Click to expand" data-collapse="Click to minimize">
              <div class="expand-tooltip" data-expand="Click to expand" data-collapse="Click to minimize"></div>
              <div class="job-header">
                <h4>Software Engineer Intern</h4>
                <span class="company">Cisco (Duo Security)</span>
                <span class="period">May 2023 ‚Äì August 2023</span>
                <span class="location">Ann Arbor, MI</span>
              </div>
              <p class="job-description">Increased code coverage and automated testing processes for the Duo ADFS product.</p>
              <div class="tech-stack">
                <span class="tech-tag">Unit Testing</span>
                <span class="tech-tag">C#</span>
                <span class="tech-tag">CI/CD</span>
                <span class="tech-tag">PowerShell</span>
                <span class="tech-tag">ADFS</span>
              </div>
              
              <!-- Expanded content that only shows when job-card has 'expanded' class -->
              <div class="expanded-content">
                <h5>Key Responsibilities & Achievements:</h5>
                <ul class="expanded-bullets">
                  <li>Significantly improved code coverage for the Duo ADFS integration product through comprehensive unit testing</li>
                  <li>Developed and maintained automated testing frameworks to streamline the development workflow</li>
                  <li>Collaborated with senior developers to identify and implement testing best practices</li>
                  <li>Participated in code reviews and contributed to improving overall code quality standards</li>
                  <li>Gained hands-on experience with enterprise security products and authentication systems</li>
                </ul>
                
                <h5>Technical Projects:</h5>
                <ul class="expanded-bullets">
                  <li>Created automated test suites for ADFS integration functionality</li>
                  <li>Implemented CI/CD pipeline improvements for automated testing and deployment</li>
                  <li>Developed PowerShell scripts for testing and validation of ADFS configurations</li>
                  <li>Contributed to documentation and knowledge sharing within the development team</li>
                </ul>
              </div>
            </div>
          </div>
          
          <div class="skills-section">
            <h3>Technical Skills</h3>
            
            <div class="skill-category">
              <h4>Languages</h4>
              <div class="skill-items">
                <span class="skill-item">C#</span>
                <span class="skill-item">C++</span>
                <span class="skill-item">JavaScript</span>
                <span class="skill-item">Python</span>
                <span class="skill-item">Swift</span>
              </div>
            </div>
            
            <div class="skill-category">
              <h4>Frameworks & Tools</h4>
              <div class="skill-items">
                <span class="skill-item">.NET</span>
                <span class="skill-item">Azure</span>
                <span class="skill-item">React</span>
                <span class="skill-item">SwiftUI</span>
              </div>
            </div>
            
            <div class="skill-category">
              <h4>Security & Infrastructure</h4>
              <div class="skill-items">
                <span class="skill-item">ADFS</span>
                <span class="skill-item">MFA Systems</span>
                <span class="skill-item">Azure AD</span>
                <span class="skill-item">Network Security</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>

  <!-- Skills section has been combined with Experience page -->


          



</main>

<footer>
  <p>&copy; 2025 Owen Kelley</p>
</footer>

<script>
  // ===== Role Typewriter (subtitle) =====
  (function(){
    const hiEl   = document.getElementById('hiLine');
    const nameEl = document.getElementById('nameLine');
    if(!hiEl || !nameEl) return;

    const reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const HI   = "Hi, my name is";
    const NAME = "Owen";    // keep your period if you want it
    const TYPE = 125;        // slow it down if you like

    function typeTo(el, text, i = 0, done){
      if (reduce) { el.textContent = text; done && done(); return; }
      el.textContent = text.slice(0, i);
      if (i < text.length) setTimeout(() => typeTo(el, text, i + 1, done), TYPE);
      else done && done();
    }

    function startTyping(){
      typeTo(hiEl, HI, 0, () => {
        document.querySelector('.intro-line.small .caret')?.remove();   // remove small caret

        // Slight pause, then set text and fade the big line in
        setTimeout(() => {
          nameEl.textContent = NAME;
          (document.getElementById('bigLine') || document.querySelector('.intro-line.big'))?.classList.add('show');
            // üëâ tell the rest of the page the name is visible
          window.dispatchEvent(new Event('name-shown'));
        }, 300);
      });
    }

    let started = false;
    function kick(){
      if (started) return;
      if ((location.hash || '#/home') === '#/projects') return;
      started = true;
      startTyping();
    }

    // Start ONLY after the overlay reveals
    window.addEventListener('hero-revealed', kick, { once: true });
  })();

  // === Helpers ===
  function getHeaderH(){
    const v = getComputedStyle(document.documentElement).getPropertyValue('--headerH').trim();
    const n = parseFloat(v);
    return isNaN(n) ? 80 : n;
  }
  function smoothScrollTo(y){ window.scrollTo({ top: y, behavior: 'smooth' }); }

  // === Simple hash router (#/home, #/projects) ===
  (function(){
    const pages = {
      home: document.querySelector('.home-page'),
      about: document.querySelector('.about-page'),
      experience: document.querySelector('.experience-page'),
      projects: document.querySelector('.projects-page')
    };
    const navLinks = Array.from(document.querySelectorAll('nav a'));
    let homeSpyObserver = null;
    let projectsInitialized = false;

    function setNavActive(which){
      navLinks.forEach(a => {
        const r = a.getAttribute('data-route');
        a.classList.toggle('active', r === which || (which!== 'projects' && r === 'home' && which === 'home-spy'));
      });
    }

    // Scroll spy for home page (intro only)
    function initHomeSpy(){
      if(homeSpyObserver) homeSpyObserver.disconnect();
      const ids = ['intro'];
      const headerH = getHeaderH();
      homeSpyObserver = new IntersectionObserver((entries)=>{
        entries.forEach(entry => { if(entry.isIntersecting){
          const id = entry.target.id;
          navLinks.forEach(a=>{
            const r = a.getAttribute('data-route');
            const match = (id==='intro' && r==='home');
            a.classList.toggle('active', match);
          });
        }});
      }, { root: null, threshold: 0.55, rootMargin: `-${headerH}px 0px -40% 0px` });
      ids.forEach(id => { const el = document.getElementById(id); if(el) homeSpyObserver.observe(el); });
    }

    function showPage(which){
      // Hide all pages first
      Object.values(pages).forEach(page => page.classList.remove('active'));
      
      // Show the selected page
      if(pages[which]) {
        pages[which].classList.add('active');
      }



      if(which === 'projects'){
        if(homeSpyObserver) homeSpyObserver.disconnect();
        setNavActive('projects');
        if(!projectsInitialized){ initProjectsPage(); projectsInitialized = true; }
      } else if(which === 'home') {
        initHomeSpy();
        smoothScrollTo(0);
        
        // Check if we unlocked from a non-home page and need to trigger intro text
        if (window.__unlockedFromNonHome) {
          console.log('Unlocked from non-home page, triggering intro text...');
          // Clear the flag
          window.__unlockedFromNonHome = false;
          
          // Trigger the intro text display with a slight delay to ensure DOM is ready
          setTimeout(() => {
            const introText = document.querySelector('.home-page #intro .intro-text');
            if (introText && !introText.classList.contains('show')) {
              introText.classList.add('show');
              console.log('Successfully triggered intro text after unlocking from non-home page');
            }
          }, 100);
        } else {
          // Normal home page navigation - ensure intro text is visible
          const introText = document.querySelector('.home-page #intro .intro-text');
          console.log('showPage home - introText found:', !!introText);
          if (introText && !introText.classList.contains('show')) {
            introText.classList.add('show');
            console.log('Added show class to intro text in showPage');
          } else if (introText) {
            console.log('Intro text already has show class');
          } else {
            console.warn('Intro text element not found in showPage');
            // Fallback: try again after a delay
            setTimeout(() => {
              const retryIntroText = document.querySelector('.home-page #intro .intro-text');
              if (retryIntroText && !retryIntroText.classList.contains('show')) {
                retryIntroText.classList.add('show');
                console.log('Added show class to intro text in fallback');
              }
            }, 100);
          }
        }
        
        // Update music circle center when returning to home
        setTimeout(() => {
          if (window.__updateMusicCenter) {
            window.__updateMusicCenter();
          }
        }, 200);
      } else if(which === 'experience') {
        setNavActive(which);
        smoothScrollTo(0);
        // Initialize experience page functionality
        if(!window.experienceInitialized) {
          initExperiencePage();
          window.experienceInitialized = true;
        }
      } else {
        // For other pages, just set the nav active
        setNavActive(which);
        smoothScrollTo(0);
      }
    }

    function parseRoute(){
      const hash = location.hash || '#/home';
      const m = hash.match(/^#\/(.*)$/);
      const r = m ? m[1] : 'home';
      if(['home','about','experience','projects'].includes(r)) return r;
      return 'home';
    }

    window.addEventListener('hashchange', ()=> showPage(parseRoute()));
    document.addEventListener('DOMContentLoaded', ()=> showPage(parseRoute()));
  })();

  // === Projects page logic ===
  function initProjectsPage(){
    console.log('Initializing projects page...');
    
    // Initialize click-based project expansion
    const projectItems = document.querySelectorAll('.project-item');
    const projectsGrid = document.querySelector('.projects-grid');
    
    console.log('Found project items:', projectItems.length);
    console.log('Found projects grid:', projectsGrid);
    
    if (!projectItems.length || !projectsGrid) {
      console.error('Projects page elements not found!');
      return;
    }
    
    projectItems.forEach((item, index) => {
      console.log(`Adding click listener to project ${index + 1}`);
      
      // Initialize tooltip text
      const tooltip = item.querySelector('.expand-tooltip');
      if (tooltip) {
        tooltip.textContent = tooltip.dataset.expand;
      }
      
      item.addEventListener('click', function(e) {
        console.log(`Project ${index + 1} clicked!`);
        e.stopPropagation();
        
        // If this item is already expanded, collapse it
        if (this.classList.contains('expanded')) {
          this.classList.remove('expanded');
          projectsGrid.classList.remove('has-expanded');
          // Update tooltip text back to expand
          const tooltip = this.querySelector('.expand-tooltip');
          if (tooltip) {
            tooltip.textContent = tooltip.dataset.expand;
          }
        } else {
          // Collapse any previously expanded item
          projectItems.forEach(project => {
            project.classList.remove('expanded');
            const tooltip = project.querySelector('.expand-tooltip');
            if (tooltip) {
              tooltip.textContent = tooltip.dataset.expand;
            }
          });
          projectsGrid.classList.remove('has-expanded');
          
          // Expand this item
          this.classList.add('expanded');
          projectsGrid.classList.add('has-expanded');
          // Update tooltip text to collapse
          const tooltip = this.querySelector('.expand-tooltip');
          if (tooltip) {
            tooltip.textContent = tooltip.dataset.collapse;
          }
        }
      });
    });
    
    // Click outside to collapse (optional)
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.project-item') && !e.target.closest('.projects-grid')) {
        projectItems.forEach(project => project.classList.remove('expanded'));
        projectsGrid.classList.remove('has-expanded');
      }
    });
    
    console.log('Projects page initialized with click-based expansion');
  }

  // === Experience page logic ===
  function initExperiencePage(){
    console.log('Initializing experience page...');
    
    // Initialize click-based job card expansion
    const jobCards = document.querySelectorAll('.job-card');
    
    console.log('Found job cards:', jobCards.length);
    
    if (!jobCards.length) {
      console.error('Job cards not found!');
      return;
    }
    
    jobCards.forEach((jobCard, index) => {
      console.log(`Adding click listener to job card ${index + 1}`);
      
      // Initialize tooltip text
      const tooltip = jobCard.querySelector('.expand-tooltip');
      if (tooltip) {
        tooltip.textContent = tooltip.dataset.expand;
      }
      
      jobCard.addEventListener('click', function(e) {
        console.log(`Job card ${index + 1} clicked!`);
        e.stopPropagation();
        
        // If this item is already expanded, collapse it
        if (this.classList.contains('expanded')) {
          this.classList.remove('expanded');
          this.closest('.experience-section').classList.remove('has-expanded');
          // Update tooltip text back to expand
          const tooltip = this.querySelector('.expand-tooltip');
          if (tooltip) {
            tooltip.textContent = tooltip.dataset.expand;
          }
        } else {
          // Collapse any previously expanded item
          jobCards.forEach(job => {
            job.classList.remove('expanded');
            const tooltip = job.querySelector('.expand-tooltip');
            if (tooltip) {
              tooltip.textContent = tooltip.dataset.expand;
            }
          });
          
          // Remove has-expanded from all sections
          document.querySelectorAll('.experience-section').forEach(section => {
            section.classList.remove('has-expanded');
          });
          
          // Expand this item
          this.classList.add('expanded');
          this.closest('.experience-section').classList.add('has-expanded');
          // Update tooltip text to collapse
          const tooltip = this.querySelector('.expand-tooltip');
          if (tooltip) {
            tooltip.textContent = tooltip.dataset.collapse;
          }
        }
      });
    });
    
    // Click outside to collapse (optional)
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.job-card')) {
        jobCards.forEach(job => job.classList.remove('expanded'));
        // Remove has-expanded from all sections
        document.querySelectorAll('.experience-section').forEach(section => {
          section.classList.remove('has-expanded');
        });
      }
    });
    
    console.log('Experience page initialized with click-based expansion');
  }
</script>
<script>
  /* Key-only overlay with WELCOME decode -> spin -> wipe */
  (function () {
  
    var reduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
  
    // Build overlay DOM (adds the decode text under the square)
    var overlay = document.createElement('div');
    overlay.className = 'intro-overlay';
    overlay.innerHTML =
      '<div class="sq-wrap" tabindex="0" role="button" aria-label="Enter site">' +
        '<div class="square" aria-hidden="true">' +
          '<span class="keyhole" aria-hidden="true"></span>' +
          '<div class="ripple-1" aria-hidden="true"></div>' +
          '<div class="ripple-2" aria-hidden="true"></div>' +
          '<div class="ripple-3" aria-hidden="true"></div>' +
        '</div>' +
        '<div class="decode-text" id="decodeText" aria-live="polite"></div>' +
      '</div>' +
      '<div class="white-wipe" aria-hidden="true"></div>';
    document.body.appendChild(overlay);
  
    var sq  = overlay.querySelector('.square');
    var kh  = overlay.querySelector('.keyhole');
    var wr  = overlay.querySelector('.sq-wrap');
    wr.addEventListener('pointerdown', () => {
      window.__startSiteAudio?.();   // defined in setupMusic below
    }, { once: true });
    var wipe = overlay.querySelector('.white-wipe');
    var decodeEl = overlay.querySelector('#decodeText');

    // Get intro text element dynamically since it might not exist when script runs
    function getIntroText() {
      return document.querySelector('.home-page #intro .intro-text');
    }
  
    function revealPage(){
  overlay.classList.add('revealing');
  const wipe = overlay.querySelector('.white-wipe');

  const finish = () => {
    overlay.classList.add('hidden');
    // Always show intro text when page is revealed
    const introText = getIntroText();
    console.log('revealPage finish - introText found:', !!introText);
    if (introText) {
      introText.classList.add('show');
      console.log('Added show class to intro text');
    } else {
      console.warn('Intro text element not found in revealPage');
    }
    window.dispatchEvent(new Event('hero-revealed'));   // <-- kick the typewriter
  };

  if (wipe){
    requestAnimationFrame(()=> { wipe.style.transform = 'translateY(0%)'; });
    wipe.addEventListener('transitionend', finish, { once:true });
  } else {
    finish();
  }
}

  
    // Simple decode animation: WELCOME unscrambles from random chars
    function decodeWelcome(el, word){
      return new Promise(function(resolve){
        var target = (word || 'WELCOME').toUpperCase();
        var len = target.length;
        var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%&*?';
        function rnd(){ return chars[(Math.random() * chars.length) | 0]; }
  
        var start = null, duration = 900; // ms
        function step(ts){
          if (start == null) start = ts;
          var p = Math.min(1, (ts - start) / duration);
          var revealCount = Math.floor(p * len);
          var out = '';
          for (var i=0; i<len; i++){
            out += (i < revealCount) ? target[i] : rnd();
          }
          el.textContent = out;
          if (p < 1) requestAnimationFrame(step);
          else {
            el.textContent = target;
            resolve();
          }
        }
        // set initial scrambled string so screen readers get something stable
        el.textContent = Array(len).fill('¬∑').join('');
        requestAnimationFrame(step);
      });
    }
  
    let started = false;
    function startSequence(){
      if (started) return;
      started = true;
      window.dispatchEvent(new Event('hero-unlocked'));

      if (reduce){
        decodeEl.textContent = 'WELCOME';
        revealPage();
        return;
      }
      
      // Check if we're on a non-home page and skip animation if so
      const currentRoute = location.hash || '#/home';
      if (currentRoute !== '#/home') {
        // Skip animation but still initialize everything
        decodeEl.textContent = 'WELCOME';
        revealPage();
        // Set a flag to indicate we unlocked from a non-home page
        window.__unlockedFromNonHome = true;
        // Ensure music circle is initialized even when skipping animation
        setTimeout(() => {
          if (window.__updateMusicCenter) {
            window.__updateMusicCenter();
          }
        }, 100);
        return;
      }

      // Reset any hover states and ensure clean animation state
      sq.style.animationPlayState = 'running';
      sq.style.filter = 'none';
      
      // show the reserved line without causing layout shift
      decodeEl.style.visibility = 'visible';

      decodeWelcome(decodeEl, 'WELCOME').then(function(){
        setTimeout(function(){
          sq.addEventListener('animationend', function(e){
            if (e.animationName === 'spin360'){
              wr.classList.add('lift');
              requestAnimationFrame(revealPage);
            }
          }, { once:true });

          sq.classList.add('spin');
          if (kh) kh.classList.add('spin');
        }, 100);
      });
    }

  
    // interactions
    wr.addEventListener('click', startSequence);
    wr.addEventListener('keydown', function(e){
      if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); startSequence(); }
    });
  
    // if reduced motion is set at load, just show page
    if (reduce) {
      decodeEl.textContent = 'WELCOME';
      revealPage();
      // Ensure intro text is shown
      const introText = getIntroText();
      if (introText) introText.classList.add('show');
    }
  })();
  </script>   
<script>
  (function setupMusic(){
    const audio  = document.getElementById('heroTrack');
    const canvas = document.getElementById('musicViz');
    const chip   = document.getElementById('audioChip');
    const toggle = document.getElementById('audioToggle');
    if (!audio || !canvas || !chip || !toggle) return;
  
    // Show chip after wipe; start on lock click
    chip.hidden = true;
    window.addEventListener('hero-revealed', () => { chip.hidden = false; }, { once:true });
    window.addEventListener('hero-unlocked', () => { play().catch(()=>{}); }, { once:true });
  
    /* ===== Look & feel ===== */
    const BINS         = 168;   // many bars ‚Üí smoother circle
    const RADIUS_FR    = 0.28;  // base radius (fraction of min viewport)
    const BAR_FR       = 0.14;  // max bar length (keeps highs in check)
    const DECAY        = 0.82;  // time smoothing only (lower = snappier)
    const TOUCH_FR     = 0.97;  // 0..1 ‚Äî thickness as % of available arc (tiny gaps)
    const ROTATE_SPEED = 0.02;  // revs per second
            const COLOR        = '#374151'; // bar color
    const OPACITY      = 1.00;  // stroke opacity
    const GLOW         = 0;     // 0 = razor crisp (no blur)
    const GAMMA        = 0.85;  // compress peaks (lower = flatter)
    const MIN_FR       = 0.030; // minimum bar length fraction (never vanish)
    const ACTIVE_GAIN = 0.7;     // normal listening level
    const IDLE_GAIN   = 0.0005;  // "paused" level (almost silent)
    const FADE_MS     = 0.35;    // fade time in seconds
        // Frequency shaping (visual only)
    const LOW_CUT_HZ = 60;      // ignore sub-bass thump/DC
    const HIGH_CUT_HZ = 12000;  // cap highs (less noisy)
    const LOG_EXP     = 1.7;    // 1 = linear, higher = more low-end compression
    const EQ_TILT     = 0.6;    // 0..1 ‚Äî more -> boosts highs visually


  
    /* ===== Canvas ===== */
    const ctx = canvas.getContext('2d');
    let w=0, h=0, dpr=1, cx=0, cy=0;
  
    function updateCenter(){
      // Try to find the name element first
      const nameSpot = document.querySelector('#bigLine .name-spot');
      const bigLine = document.getElementById('bigLine');
      
      if (nameSpot && nameSpot.offsetParent !== null) {
        // Name spot is visible, use it
        const r = nameSpot.getBoundingClientRect();
        cx = Math.round((r.left + r.width/2) * dpr);
        cy = Math.round((r.top + r.height/2) * dpr);
      } else if (bigLine && bigLine.offsetParent !== null) {
        // Big line is visible, use it
        const r = bigLine.getBoundingClientRect();
        cx = Math.round((r.left + r.width/2) * dpr);
        cy = Math.round((r.top + r.height/2) * dpr);
      } else {
        // Fallback to center of viewport
        cx = Math.round((window.innerWidth / 2) * dpr);
        cy = Math.round((window.innerHeight / 2) * dpr);
      }
    }
    function resize(){
      dpr = Math.min(2, window.devicePixelRatio || 1);
      w = canvas.width  = Math.floor(innerWidth  * dpr);
      h = canvas.height = Math.floor(innerHeight * dpr);
      canvas.style.width  = innerWidth + 'px';
      canvas.style.height = innerHeight + 'px';
      updateCenter();
    }
    window.addEventListener('resize', resize);
    window.addEventListener('hero-revealed', updateCenter);
    window.addEventListener('name-shown', updateCenter, { once:true });
    
    // Add navigation event listener to fix music circle positioning
    window.addEventListener('hashchange', function() {
      if (location.hash === '#/home' || location.hash === '') {
        // Small delay to ensure DOM is ready
        setTimeout(updateCenter, 100);
      }
    });
    
    resize();
  
    /* ===== Audio ===== */
    let ac=null, analyser=null, freq=null, gainNode=null;

    function ensureAudio(){
      if (ac) return;
      ac = new (window.AudioContext || window.webkitAudioContext)();
      const src  = ac.createMediaElementSource(audio);
      gainNode   = ac.createGain();
      gainNode.gain.value = 0.0001;                 // start silent (so we can fade in)
      analyser   = ac.createAnalyser(); analyser.fftSize = 1024;
      freq       = new Uint8Array(analyser.frequencyBinCount);

      src.connect(gainNode);
      gainNode.connect(analyser);
      analyser.connect(ac.destination);
    }

    function fadeGain(target, secs = FADE_MS){
      if (!gainNode || !ac) return;
      const t = ac.currentTime;
      const start = Math.max(0.0001, gainNode.gain.value);
      gainNode.gain.cancelScheduledValues(t);
      gainNode.gain.setValueAtTime(start, t);
      // exponentialRamp can't go to 0, so clamp to a tiny >0
      gainNode.gain.exponentialRampToValueAtTime(Math.max(0.0001, target), t + secs);
    }

  
    /* ===== Bars (no neighbor blur) ===== */
    const smooth = new Float32Array(BINS).fill(0.18); // seed so all bars start visible
    let angleOffset = 0, last = performance.now();
  
    function drawRadialBars(){
      analyser.getByteFrequencyData(freq);
  
      // --- pick bins with low-cut + log mapping + gentle high tilt ---
      const binHz   = ac.sampleRate / analyser.fftSize;
      const start   = Math.max(1, Math.floor(LOW_CUT_HZ  / binHz));
      const end     = Math.min(freq.length - 1, Math.floor(HIGH_CUT_HZ / binHz));
      const span    = Math.max(1, end - start);

      for (let i = 0; i < BINS; i++) {
        // log-ish distribution across usable band
        const t   = i / (BINS - 1);                 // 0..1 around ring
        const u   = Math.pow(t, LOG_EXP);           // bias away from bass
        const idx = start + Math.min(span - 1, Math.floor(u * span));

        // small neighbor average to avoid a single spike
        const i0 = Math.max(start, idx - 1);
        const i1 = idx;
        const i2 = Math.min(end,   idx + 1);
        let v = (freq[i0] + freq[i1] + freq[i2]) / (3 * 255);

        // gentle high-frequency visual boost
        const hi = (idx - start) / span;            // 0..1 low‚Üíhigh
        v *= (0.7 + 0.3 * Math.pow(hi, EQ_TILT));   // keep <= ~1

        // time smoothing you already had
        smooth[i] = smooth[i] * DECAY + v * (1 - DECAY);
      }

  
      const minwh  = Math.min(w,h);
      const baseR  = minwh * RADIUS_FR;
      const maxLen = minwh * BAR_FR;
  
      // thickness so bars nearly touch (tiny white space remains)
      const arcPerBin = (2 * Math.PI * baseR) / BINS;
      const lineW     = Math.max(2*dpr, arcPerBin * TOUCH_FR);
  
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      ctx.globalAlpha = OPACITY;
      ctx.shadowColor = COLOR;
      ctx.shadowBlur  = GLOW * dpr;
  
      for (let i=0;i<BINS;i++){
        const a  = angleOffset + (i / BINS) * Math.PI * 2;
        const ax = Math.cos(a), ay = Math.sin(a);
  
        // gamma-compress + minimum floor so lengths stay distinct & always visible
        const eased = Math.pow(Math.max(smooth[i], MIN_FR), GAMMA);
        const len   = eased * maxLen;
  
        const x1 = cx + ax * baseR;
        const y1 = cy + ay * baseR;
        const x2 = cx + ax * (baseR + len);
        const y2 = cy + ay * (baseR + len);
  
        const LIGHT = '#6B7280';   // lighter effect

        const g = ctx.createLinearGradient(x1, y1, x2, y2);
        g.addColorStop(0.00, 'rgba(107,114,128,0)');   // LIGHT @ 0% alpha
        g.addColorStop(0.18, 'rgba(107,114,128,0.5)'); // LIGHT 50%
        g.addColorStop(1.00, 'rgba(107,114,128,1)');   // LIGHT 100%
        ctx.strokeStyle = g;
        ctx.shadowColor = 'rgba(124,129,137,1)';       // if you‚Äôre using glow
  
        ctx.strokeStyle = g;
        ctx.lineWidth   = lineW;
  
        ctx.beginPath();
        ctx.moveTo(x1,y1);
        ctx.lineTo(x2,y2);
        ctx.stroke();
      }
  
      ctx.globalAlpha = 1;
      ctx.shadowBlur = 0;
    }
    
    // Draw static neutral bars when paused
    function drawStaticBars(){
      const minwh  = Math.min(w,h);
      const baseR  = minwh * RADIUS_FR;
      const neutralLen = minwh * BAR_FR * 0.18; // Use the seed value for neutral length
      
      // thickness so bars nearly touch (tiny white space remains)
      const arcPerBin = (2 * Math.PI * baseR) / BINS;
      const lineW     = Math.max(2*dpr, arcPerBin * TOUCH_FR);
      
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      ctx.globalAlpha = OPACITY * 0.5; // Slightly dimmed when paused
      ctx.shadowColor = COLOR;
      ctx.shadowBlur  = GLOW * dpr * 0.5; // Reduced glow when paused
      
      for (let i=0;i<BINS;i++){
        const a  = angleOffset + (i / BINS) * Math.PI * 2;
        const ax = Math.cos(a), ay = Math.sin(a);
        
        const x1 = cx + ax * baseR;
        const y1 = cy + ay * baseR;
        const x2 = cx + ax * (baseR + neutralLen);
        const y2 = cy + ay * (baseR + neutralLen);
        
        const LIGHT = '#6B7280';   // lighter effect

        const g = ctx.createLinearGradient(x1, y1, x2, y2);
        g.addColorStop(0.00, 'rgba(107,114,128,0)');   // LIGHT @ 0% alpha
        g.addColorStop(0.18, 'rgba(107,114,128,0.5)'); // LIGHT 50%
        g.addColorStop(1.00, 'rgba(107,114,128,1)');   // LIGHT 100%
        ctx.strokeStyle = g;
        ctx.shadowColor = 'rgba(107,114,128,1)';       // if you're using glow
        
        ctx.lineWidth   = lineW;
        
        ctx.beginPath();
        ctx.moveTo(x1,y1);
        ctx.lineTo(x2,y2);
        ctx.stroke();
      }
      
      ctx.globalAlpha = 1;
      ctx.shadowBlur = 0;
    }
    

  
    /* ===== Loop & controls ===== */
    let running=false, rafId=0;
    function frame(now){
      const dt = Math.min(0.05, (now - last) / 1000);
      last = now;
  
      angleOffset += ROTATE_SPEED * dt * Math.PI * 2;
  
      rafId = requestAnimationFrame(frame);
      ctx.clearRect(0,0,w,h);
      
      if (!running || !analyser) {
        // When paused, draw static neutral bars
        drawStaticBars();
        return;
      }
  
      drawRadialBars();
    }
  
    async function play(){
      ensureAudio();
      if (ac.state === 'suspended') await ac.resume();
      try { await audio.play(); } catch (_) {}

      fadeGain(ACTIVE_GAIN);                 // fade up to normal
      running = true;                        // keep ring animating
      toggle.setAttribute('aria-pressed','true');
      toggle.textContent = '‚ô´ Pause';
      if (!rafId) rafId = requestAnimationFrame(frame);
    }


// Change pause() to "quiet" instead of stopping everything
    function pause(){
      ensureAudio();
      fadeGain(IDLE_GAIN, FADE_MS);                  // drop to near-silent
      running = false;                               // stop the animation loop
      
      // Reset bars to neutral state when pausing
      for (let i = 0; i < BINS; i++) {
        smooth[i] = 0.18; // Reset to the initial seed value
      }
      
      toggle.setAttribute('aria-pressed','false');
      toggle.textContent = '‚ô´ Play';
      // DO NOT call audio.pause(); keep it playing quietly
    }

    toggle.addEventListener('click', () =>
      toggle.getAttribute('aria-pressed') === 'true' ? pause() : play()
    );

    window.__startSiteAudio = () => { play().catch(()=>{}); };
    window.__updateMusicCenter = updateCenter;

  })();
  </script>  
  <script>
 (function roleRotator(){
  const rot = document.getElementById('roleRotator');
  if(!rot) return;

  const phrases = [
    "An engineer",
    "A builder",
    "Security-minded",
    "A problem solver"
  ];

  const HOLD_MS    = 2200;  // how long each phrase stays
  const FIRST_DELAY = 550;  // <-- wait this long after "Owen." shows
  let idx = 0, timer = null;

  function mount(text, cls){
    const el = document.createElement('span');
    el.className = 'item ' + (cls || '');
    el.textContent = text;
    rot.appendChild(el);
    return el;
  }

  function next(){
    const prev = rot.querySelector('.item.in');
    const el   = mount(phrases[idx % phrases.length], 'in');
    idx++;

    if (prev){
      prev.classList.remove('in');
      prev.classList.add('out');
      prev.addEventListener('animationend', ()=> prev.remove(), { once:true });
    }
    timer = setTimeout(next, HOLD_MS);
  }

  // Start shortly after the big name appears
  window.addEventListener('name-shown', () => {
    setTimeout(() => {
      mount(phrases[0], 'in');  // will play your rrIn animation
      idx = 1;
      timer = setTimeout(next, HOLD_MS);
    }, FIRST_DELAY);
  }, { once:true });
    })();
    </script>



    <!-- Experience Page Animations -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
        // Initialize experience page animations
        function initExperienceAnimations() {
          const timelineItems = document.querySelectorAll('.timeline-item');
          const stats = document.querySelectorAll('.stat-number');
          
          // Animate stats on scroll
          const animateStats = () => {
            stats.forEach(stat => {
              const target = parseInt(stat.textContent.replace(/\D/g, ''));
              const suffix = stat.textContent.replace(/\d/g, '');
              let current = 0;
              const increment = target / 50;
              
              const updateStat = () => {
                if (current < target) {
                  current += increment;
                  stat.textContent = Math.floor(current) + suffix;
                  requestAnimationFrame(updateStat);
                } else {
                  stat.textContent = target + suffix;
                }
              };
              
              updateStat();
            });
          };

          // Intersection Observer for timeline items
          const observer = new IntersectionObserver((entries) => {
            entries.forEach((entry, index) => {
              if (entry.isIntersecting) {
                setTimeout(() => {
                  entry.target.classList.add('visible');
                  entry.target.classList.add('aos-animate');
                }, index * 200);
              }
            });
          }, {
            threshold: 0.3,
            rootMargin: '0px 0px -100px 0px'
          });

          timelineItems.forEach(item => observer.observe(item));

          // Animate stats when they come into view
          const statsObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                animateStats();
                statsObserver.unobserve(entry.target);
              }
            });
          }, { threshold: 0.5 });

          const statsContainer = document.querySelector('.experience-stats');
          if (statsContainer) {
            statsObserver.observe(statsContainer);
          }
        }

        // Initialize when experience page is shown
        window.addEventListener('hashchange', function() {
          if (location.hash === '#/experience') {
            setTimeout(initExperienceAnimations, 100);
          }
        });

        // Initialize if already on experience page
        if (location.hash === '#/experience') {
          setTimeout(initExperienceAnimations, 100);
        }
      });
    </script>
    
</body>    
</html>
